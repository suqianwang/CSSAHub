<% if session.has_key?('login') and session['login'] == "admin" %>
<%= link_to 'Back to Admin Page', admin_index_path %>
<% end %>

<p id="notice"><%= notice %></p>

<div class="center">
  <h1>Accounts</h1>

  <table class="table table-striped">
    <thead>
    <tr>
      <th>Username</th>
      <th>Name</th>
      <th>Email</th>
      <th>Created On</th>
      <th colspan="3">Actions</th>
    </tr>
    </thead>

    <tbody>
    <% @accounts.each do |account| %>
      <tr>
        <td style="width:auto"><%= account.username %></td>
        <td><%= account.name %></td>
        <td><%= account.email %></td>
        <td><%= account.created_at.strftime("%m/%d/%Y") %></td>
        <td>
          <button class="btn btn-danger" data-toggle="modal" data-target="#deleteForm-<%= account.username %>" id="delete-<%= account.username %>">Delete
            User
          </button>
        </td>


        <div class="modal fade" id="deleteForm-<%= account.username %>">
          <div class="modal-dialog">
            <div class="modal-content">
              <div class="modal-header">
                <h5 class="modal-title">Confirm Delete</h5>
                <button type="button" class="close" data-dismiss="modal">
                  <span>&times;</span>
                </button>
              </div>

              <form>
                <div class="modal-body">

                  <h5>Delete user: <%= account.username %></h5>
                  <p>Please enter the reason for deletion:</p>
                  <div class="form-group">
                    <%= text_area_tag :reason, "", class: "form-control" %>
                  </div>
                </div>

                <div class="modal-footer">
                  <%= link_to account, method: :delete, :id => "confirmDeletion-" + account.username, :reason => :reason do %>
                    <button type="submit" class="btn btn-danger">Delete</button>
                  <% end %>
                </div>
              </form>

            </div>
          </div>
        </div>
      </tr>
    <% end %>
    </tbody>
  </table>
</div>
